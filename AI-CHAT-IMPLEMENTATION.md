# AI Chat System - Conversational & Crisis-Aware Implementation

## ЁЯОп Overview

The chat system is now **fully AI-powered, conversational, and crisis-aware** with deep understanding of Bangladeshi context, culture, and emergency resources.

## тЬи Key Features Implemented

### 1. **Conversational AI** ЁЯдЦ

**OLD BEHAVIOR:**
- Robotic, template responses
- No follow-up questions
- Generic, one-size-fits-all answers

**NEW BEHAVIOR:**
- Warm, friendly like talking to a trusted friend
- Asks follow-up questions to understand better
- Shows empathy and validates feelings
- References Bangladeshi culture naturally (TSC, Hatirjheel, DU, BUET, family pressures, etc.)
- Uses examples relevant to Bangladesh daily life

**Example Conversation:**
```
User: ржкржбрж╝рж╛рж╢рзЛржирж╛ржпрж╝ рж╕рж╛рж╣рж╛ржпрзНржп ржЪрж╛ржЗ
Bot: ржЕржмрж╢рзНржпржЗ! ржЖржорж┐ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рждрзЗ ржкрж╛рж░рж┐ред ржмрж▓рзЛ рждрзЛ, рждрзБржорж┐ ржХрзЛржи ржХрзНрж▓рж╛рж╕рзЗ ржкржбрж╝рзЛ? ржПржмржВ ржХрзЛржи ржмрж┐рж╖ржпрж╝рзЗ ржмрзЗрж╢рж┐ рж╕ржорж╕рзНржпрж╛ рж╣ржЪрзНржЫрзЗ?
```

### 2. **Crisis Detection & Safety** ЁЯЪи

**AUTOMATIC DETECTION:**
The AI now automatically detects if a user mentions:
- Abuse (physical, emotional, sexual, online harassment)
- Violence or threatening behavior
- Harassment (workplace, educational, street)
- Feeling unsafe or in danger
- Suicidal thoughts or severe depression
- Need for urgent help

**IMMEDIATE RESPONSE:**
When crisis detected, AI provides:

1. **Acknowledgment** - "ржЖржкржирж┐ рж╕рж╛рж╣рж╕рзА ржпрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржЦрзБржБржЬржЫрзЗржи"
2. **Emergency Numbers** - Prominently displayed
3. **App Features** - Direct to Report & SOS page
4. **Continued Support** - "ржЖржорж┐ ржПржЦржиржУ ржЖржкржирж╛рж░ рж╕рж╛ржерзЗ ржЖржЫрж┐"

### 3. **Bangladesh Emergency Resources** ЁЯУЮ

All bots now include these contacts when needed:

```
ЁЯЪи 999 - National Emergency Service (Police, Ambulance, Fire)
ЁЯСотАНтЩАя╕П 109 - Women & Children Helpline (24/7)
ЁЯПе 16263 - National Mental Health Helpline (24/7)
ЁЯТм 09666777222 - Kaan Pete Roi Mental Health Support (24/7)
ЁЯУЮ 10921 - One Stop Crisis Center (OCC) for women
ЁЯФТ 01320-020408 - Cyber Crime Helpline

FREE LEGAL AID:
- BLAST: 01714-090909
- ASK (Ain o Salish Kendra): 01755-652916
- BNWLA: Bangladesh National Women Lawyers Association
```

### 4. **Specialized Bot Enhancements** ЁЯОп

#### **Academic Bot** ЁЯУЪ
- Understands SSC/HSC/JSC exam pressure
- Knows about DU, BUET, Medical college admissions
- References coaching culture (Udvash, Retina)
- Acknowledges load-shedding, space issues, family pressure
- Detects academic stress and provides mental health resources

#### **Health Bot** тЭдя╕П
- Safe space for reproductive health questions (often not discussed in families)
- Understands stigma around mental health in BD
- Knows about govt hospitals (free/low cost), Marie Stopes clinics
- Acknowledges that women often can't easily access healthcare
- Provides Kaan Pete Roi (09666777222) for free counseling

#### **Legal Rights Bot** тЪЦя╕П
- Digital Security Act 2018 expertise
- Women's rights, marriage, divorce, inheritance laws
- Cyber crime reporting (Digital Security Agency)
- Acknowledges police can be unhelpful but emphasizes legal rights
- References One Stop Crisis Centers (OCC) at medical colleges
- Provides free legal aid contacts

#### **Safety & Reporting Bot** ЁЯЫбя╕П
- **FIRST QUESTION ALWAYS:** "ржЖржкржирж┐ ржПржЦржи ржХрж┐ ржирж┐рж░рж╛ржкржж ржЖржЫрзЗржи?"
- Evidence collection guidance (screenshots, timeline, safe storage)
- GD/FIR filing procedures
- Safety planning (safe places, emergency contacts, exit strategies)
- **Prominently shows 999 and 109** if in danger
- Directs to **Report & SOS page** in app for confidential reporting

#### **Skills Development Bot** ЁЯТ╗
- Understands Bangladesh is 2nd largest freelance market globally
- Focuses on free resources (freeCodeCamp, YouTube, govt e-learning)
- BD job market trends and salary expectations
- Local tech companies (bKash, Pathao, Chaldal, Brain Station 23)
- Freelancing platforms strategies for Bangladeshis
- Acknowledges electricity/internet issues affecting learning

#### **Crisis Intervention Bot** ЁЯЪи
**HIGHEST PRIORITY - IMMEDIATE EMERGENCIES**

**Response Format:**
```
"ржЖржорж┐ ржПржЦрж╛ржирзЗ ржЖржкржирж╛рж░ рж╕рж╛ржерзЗ ржЖржЫрж┐ред ржЖржкржирж┐ ржПржЦржи ржХрж┐ ржирж┐рж░рж╛ржкржж ржЖржЫрзЗржи?"

ЁЯЪи ржЬрж░рзБрж░рж┐ рж╕рж╛рж╣рж╛ржпрзНржп:
ЁЯУЮ 999 - CALL NOW (Police Emergency)
ЁЯСотАНтЩАя╕П 109 - Women Helpline (24/7)
ЁЯТм 09666777222 - Kaan Pete Roi (24/7)
ЁЯПе 16263 - Mental Health (24/7)

ЁЯУ▒ ржПржЗ ржЕрзНржпрж╛ржкрзЗрж░ SOS ржмрж╛ржЯржи ржЪрж╛ржкрзБржи ржЬрж░рзБрж░рж┐ рж╕рж╛рж╣рж╛ржпрзНржпрзЗрж░ ржЬржирзНржпред
```

**Approach:**
- De-escalation techniques (grounding, breathing, focus on present)
- Immediate danger assessment
- Clear action steps
- Connection to professional help
- Never minimizes crisis

#### **Post-Care Support Bot** ЁЯМ▒
- Celebrates every small win
- Acknowledges healing isn't linear
- Provides continued support resources
- Connects to Community feature for peer support
- Forward-looking and encouraging

#### **Community Connect Bot** ЁЯдЭ
- Peer support groups in Bangladesh
- Women's organizations (Mahila Parishad, BNWLA)
- Professional networks (Women in Tech BD, BASIS)
- University alumni groups
- Safe community engagement guidelines

#### **General Bot** ЁЯТм
- Broad knowledge base
- Routes to specialized bots for deeper help
- **Always monitors for crisis keywords**
- Provides emergency resources if ANY crisis detected
- Friendly peer tone with knowledgeable guidance

## ЁЯОм Example Crisis Detection

**User Input Examples That Trigger Crisis Response:**

```
"ржХрзЗржЙ ржЖржорж╛ржХрзЗ рж╣ржпрж╝рж░рж╛ржирж┐ ржХрж░ржЫрзЗ"
"I'm being harassed"
"ржЖржорж┐ ржирж┐рж░рж╛ржкржж ржиржпрж╝"
"Someone is abusing me"
"ржЖрждрзНржорж╣рждрзНржпрж╛рж░ ржХржерж╛ ржнрж╛ржмржЫрж┐"
"I want to hurt myself"
"Feeling very unsafe"
```

**AI Response:**
```
ржЖржкржирж╛рж░ рж╕рж╛ржерзЗ ржпрж╛ рж╣ржЪрзНржЫрзЗ рждрж╛ рж╕ржорзНржкрзВрж░рзНржг ржЕржЧрзНрж░рж╣ржгржпрзЛржЧрзНржп ржПржмржВ ржЖржкржирж┐ рж╕рж╛рж╣рж╛ржпрзНржп ржкрж╛ржУржпрж╝рж╛рж░ ржпрзЛржЧрзНржпред

тЪая╕П ржЖржкржирж┐ ржПржЦржиржЗ ржмрж┐ржкржжрзЗ ржерж╛ржХрж▓рзЗ:

ЁЯЪи CALL 999 RIGHT NOW - ржЬрж╛рждрзАржпрж╝ ржЬрж░рзБрж░рж┐ рж╕рзЗржмрж╛
ЁЯСотАНтЩАя╕П CALL 109 - ржирж╛рж░рзА ржУ рж╢рж┐рж╢рзБ рж╣рзЗрж▓рзНржкрж▓рж╛ржЗржи (24/7)

ЁЯУ▒ ржПржЗ ржЕрзНржпрж╛ржкрзЗрж░ 'Report & SOS' ржкрзЗржЬ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржи ржЧрзЛржкржирзАржпрж╝ржнрж╛ржмрзЗ рж░рж┐ржкрзЛрж░рзНржЯ ржХрж░рждрзЗред

ржкрзНрж░ржорж╛ржг рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рзБржи: Screenshots, messages, records

ржЖржкржирж╛рж░ ржирж┐рж░рж╛ржкрждрзНрждрж╛ рж╕ржмржЪрзЗржпрж╝рзЗ ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржгред ржПржЦржи ржХрж┐ ржХрж░рждрзЗ ржЪрж╛ржи? ржЖржорж┐ ржЖржкржирж╛рж░ рж╕рж╛ржерзЗ ржЖржЫрж┐ред
```

## ЁЯЗзЁЯЗй Bangladeshi Context Understanding

The AI now understands and references:

**Education:**
- Board exam pressure (JSC, SSC, HSC)
- University admission competition
- Coaching center culture
- Study challenges (load-shedding, noise, space)

**Healthcare:**
- Stigma around mental health and reproductive health
- Difficulty accessing healthcare (cost, permission, transport)
- Joint family pressures
- Mother-in-law dynamics affecting mental health

**Legal/Safety:**
- Police can be unhelpful to women (but emphasizes legal rights)
- One Stop Crisis Centers at medical colleges
- Social stigma around reporting
- Digital Security Agency for cyber crimes

**Career/Skills:**
- Bangladesh as 2nd largest freelance market
- Electricity/internet issues
- Family pressure for "traditional" jobs
- Remote work opportunities
- Local tech ecosystem

**Daily Life:**
- Traffic jams (Dhaka reality)
- Popular places (TSC, Hatirjheel, campuses)
- Cultural expectations and family dynamics
- Seasonal factors (monsoon, exam periods)

## ЁЯУ▒ App Integration

The AI now actively guides users to app features:

### **Report & SOS Page**
When crisis detected:
```
"ЁЯУ▒ ржПржЗ ржЕрзНржпрж╛ржкрзЗрж░ 'Report & SOS' ржкрзЗржЬ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржи ржЧрзЛржкржирзАржпрж╝ржнрж╛ржмрзЗред"
"Use the Report & SOS page in this app for confidential help."
```

### **Community Connect**
For post-care and ongoing support:
```
"ржПржЗ ржЕрзНржпрж╛ржкрзЗрж░ Community Connect ржлрж┐ржЪрж╛рж░ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржи 
verified communities ржЦрзБржБржЬрждрзЗред"
```

### **SOS Button**
In immediate danger:
```
"ЁЯУ▒ ржПржЗ ржЕрзНржпрж╛ржкрзЗрж░ SOS ржмрж╛ржЯржи ржЪрж╛ржкрзБржи ржПржЦржиржЗред"
"Press the SOS button in this app NOW."
```

## ЁЯФз Technical Implementation

### **Triple Fallback System:**
1. **Vercel API** (`/api/chat`) - Most secure, server-side
2. **Direct Gemini API** (`src/utils/geminiClient.ts`) - Works without Vercel
3. **Fallback Chatbot** (`src/utils/chatbotLogic.ts`) - Always available

### **Enhanced System Instructions:**

Both `api/chat.ts` and `geminiClient.ts` now include:
- Language detection and matching
- Conversational guidelines
- Crisis detection protocols
- Bangladesh context understanding
- Emergency resource templates
- App feature integration
- Tone and response length guidelines

### **Rate Limiting:**
- 20 requests per minute per user
- Client-side and server-side enforcement
- Prevents API quota exhaustion

## ЁЯзк Testing the System

### **Test Crisis Detection:**
```
1. "ржХрзЗржЙ ржЖржорж╛ржХрзЗ ржнржпрж╝ ржжрзЗржЦрж╛ржЪрзНржЫрзЗ"
   тЖТ Should show 999, 109, and Report & SOS page

2. "I'm feeling suicidal"
   тЖТ Should show mental health helplines (16263, 09666777222)

3. "Someone is harassing me online"
   тЖТ Should show cyber crime helpline and evidence collection tips
```

### **Test Conversational Flow:**
```
1. "ржЖржорж╛рж░ ржкржбрж╝рж╛рж╢рзЛржирж╛ржпрж╝ рж╕рж╛рж╣рж╛ржпрзНржп ржЪрж╛ржЗ"
   тЖТ Should ask follow-up: which class, subject, challenges

2. "I want to learn programming"
   тЖТ Should ask: current level, time available, goals
   тЖТ Provide free resources and BD job market info

3. "ржорж╛ржирж╕рж┐ржХ ржЪрж╛ржкрзЗ ржЖржЫрж┐"
   тЖТ Should empathetically respond, ask more, provide resources
```

### **Test Bangladesh Context:**
```
1. Ask about "SSC exam preparation"
   тЖТ Should reference board exams, coaching centers, specific tips

2. Ask about "freelancing in Bangladesh"
   тЖТ Should mention 2nd largest market, platforms, success stories

3. Ask about "reporting harassment"
   тЖТ Should explain GD/FIR process, OCC, women's helpline
```

## ЁЯУК Success Metrics

The system is considered successful if:

тЬЕ Users feel heard and understood (conversational, empathetic)
тЬЕ Crisis situations get immediate, appropriate responses
тЬЕ Emergency numbers are prominently displayed when needed
тЬЕ Users are directed to Report & SOS page for confidential help
тЬЕ Bangladesh-specific advice is relevant and practical
тЬЕ Follow-up questions engage users in meaningful conversation
тЬЕ Specialized bots provide domain-specific expertise
тЬЕ Fallback system ensures always-available responses

## ЁЯЪА Next Steps

**Short-term (1-2 weeks):**
- Monitor crisis detection accuracy
- Collect user feedback on conversational quality
- Track Report & SOS page usage from AI referrals
- Test emergency number click-through rates

**Medium-term (1 month):**
- Add conversation history for context continuity
- Implement user satisfaction ratings
- Create RAG system with Bangladesh legal documents
- Add voice input for accessibility

**Long-term (3-6 months):**
- Fine-tune model with Bangladesh-specific conversations
- Add image support for evidence collection guidance
- Integrate with actual emergency services (aspirational)
- Multi-turn conversation memory

## ЁЯУЭ Summary

The AI chat system is now:
- ЁЯдЦ **Truly conversational** - Not robotic, asks follow-ups, shows empathy
- ЁЯЪи **Crisis-aware** - Automatically detects danger and provides immediate help
- ЁЯЗзЁЯЗй **Bangladeshi** - Deep cultural understanding and local resources
- ЁЯУ▒ **App-integrated** - Actively directs to Report & SOS and Community features
- ЁЯЫбя╕П **Safety-first** - Emergency numbers, evidence collection, safety planning
- ЁЯТм **Multi-lingual** - Seamlessly handles Bangla, English, Banglish
- ЁЯМР **Always available** - Triple fallback ensures responses even offline

**Users now have a trusted AI companion that understands their context, detects when they need help, and actively connects them to lifesaving resources.** ЁЯМЯ
